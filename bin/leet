#!/bin/bash

self_dir=$(cd $(dirname $0) && pwd)
top_dir=$(dirname $self_dir)

usage()
{
    cat <<EOF
usage:
    leet new <file>
    leet run [gcc options] <file>...
EOF
    exit 1
}

create_file()
{
    [ $# -eq 0 ] && usage
    filename=$1
    template=$self_dir/template/template.cpp
    if [ -e $filename ]; then
        echo "ERROR: $filename exists"
        exit 10
    else
        cp $template $filename && echo $filename OK
    fi
}

build_leetcode()
{
    [ $# -eq 0 ] && usage
    include_dir=$top_dir/leetcode/include
    g++ -Wreturn-type -fsanitize=address -I$include_dir -o leetcode_solution "$@"
}

run_leetcode()
{
    build_leetcode "$@" && ./leetcode_solution
}

subcmd=$1

case $subcmd in
    new)
        shift
        create_file "$@"
        ;;
    run)
        shift
        run_leetcode "$@"
        ;;
    make | build | compile)
        shift
        build_leetcode "$@"
        ;;
    *)
        usage
        ;;
esac

